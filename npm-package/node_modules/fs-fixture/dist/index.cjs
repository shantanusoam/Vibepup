"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var i=require("fs"),c=require("path"),l=require("os");function o(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var p=o(i),a=o(c),d=o(l);class h{path;constructor(t){this.path=t}exists(t=""){return i.promises.access(a.default.join(this.path,t)).then(()=>!0,()=>!1)}rm(t=""){return i.promises.rm(a.default.join(this.path,t),{recursive:!0,force:!0})}writeFile(t,r){return i.promises.writeFile(a.default.join(this.path,t),r)}writeJson(t,r){return this.writeFile(t,JSON.stringify(r,null,2))}readFile(t,r){return i.promises.readFile(a.default.join(this.path,t),r)}}const m=p.default.realpathSync(d.default.tmpdir()),y=`fs-fixture-${Date.now()}`;let u=0;function w(){return u+=1,u}const{hasOwnProperty:j}=Object.prototype,v=(e,t)=>j.call(e,t);function f(e,t){const r=[];for(const s in e){if(!v(e,s))continue;const n=e[s];typeof n=="string"?r.push({path:a.default.join(t,s),content:n}):r.push(...f(n,a.default.join(t,s)))}return r}async function F(e){const t=a.default.join(m,`${y}-${w()}`);return await i.promises.mkdir(t,{recursive:!0}),e&&(typeof e=="string"?await i.promises.cp(e,t,{recursive:!0}):typeof e=="object"&&await Promise.all(f(e,t).map(async r=>{await i.promises.mkdir(a.default.dirname(r.path),{recursive:!0}),await i.promises.writeFile(r.path,r.content)}))),new h(t)}exports.createFixture=F;
